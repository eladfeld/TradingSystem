config:
  target: "https://localhost:3333/command"
  http:
    timeout: 5
  phases:
    - duration: 3000
      arrivalRate: 1
      name: subscribers_phase
  payload:
    path: "subscribers.csv"
    fields:
      - "username"
      - "password"
      - "age"
      - "productId"
      - "quantity"
      - "checkoutInfo"
    order: sequence
    skipHeader: false

scenarios:
  - name: "subscribers"
    flow:
      - get:
          url: "/enter"
          capture:
            json: "$.userId"
            as: userId
      - think: 0.1
      - post:
          url: "/register"
          json:
            username: "{{ username }}"
            password: "{{ password }}"
            age: "{{ age }}"
      - think: 0.1
      - post:
          url: "/login"
          json:
            userId: "{{ userId }}"
            username: "{{ username }}"
            password: "{{ password }}"
          capture:
            json: "$.userId"
            as: userId
      - loop:
        - think: 0.1
        - post:
            url: "/addProductTocart"
            json:
              userId: "{{ userId }}"
              storeId: 0
              productId: 0
              quantity: 1
        - think: 0.1
        - post:
            url: "/checkoutBasket"
            json:
              userId: "{{ userId }}"
              storeId: 0
              shippingInfo: "myInfo"
        - think: 0.1
        - post:
            url: "/completeOrder"
            json:
              userId: "{{ userId }}"
              storeId: 0
              shippingInfo: {}
              paymentInfo: {}
        count: 12
      - think: 0.1
      - post:
          url: "/logout"
          json:
            userId: "{{ userId }}"
      # - post:
      #     url: "/exit"
      #     json:
      #       userId: "{{ userId }}"
